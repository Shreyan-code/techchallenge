{
  "entities": {
    "UserProfile": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "UserProfile",
      "type": "object",
      "description": "Represents a user profile in the PetConnect application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user profile."
        },
        "userName": {
          "type": "string",
          "description": "The user's username."
        },
        "email": {
          "type": "string",
          "description": "The user's email address.",
          "format": "email"
        },
        "firstName": {
          "type": "string",
          "description": "The user's first name."
        },
        "lastName": {
          "type": "string",
          "description": "The user's last name."
        },
        "profilePicture": {
          "type": "string",
          "description": "URL of the user's profile picture.",
          "format": "uri"
        },
        "bio": {
          "type": "string",
          "description": "A short biography or description of the user."
        },
        "city": {
            "type": "string",
            "description": "The city where the user lives."
        },
        "state": {
            "type": "string",
            "description": "The state or province where the user lives."
        },
        "country": {
            "type": "string",
            "description": "The country where the user lives."
        },
        "petIds": {
          "type": "array",
          "description": "References to Pets. (Relationship: User 1:N Pet)",
          "items": {
            "type": "string"
          }
        },
        "onboardingCompleted": {
          "type": "boolean",
          "description": "Whether the user has completed the onboarding process."
        },
        "discoverable": {
          "type": "boolean",
          "description": "Whether the user's profile is discoverable in search."
        }
      },
      "required": [
        "id",
        "userName",
        "email",
        "firstName",
        "lastName"
      ]
    },
    "Pet": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Pet",
      "type": "object",
      "description": "Represents a pet in the PetConnect application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the pet."
        },
        "ownerId": {
          "type": "string",
          "description": "The UID of the user who owns the pet."
        },
        "name": {
          "type": "string",
          "description": "The pet's name."
        },
        "breed": {
          "type": "string",
          "description": "The pet's breed."
        },
        "age": {
          "type": "string",
          "description": "The pet's age."
        },
        "imageUrl": {
          "type": "string",
          "description": "URL of the pet's profile picture.",
          "format": "uri"
        },
        "bio": {
          "type": "string",
          "description": "A short biography or description of the pet."
        }
      },
      "required": [
        "id",
        "ownerId",
        "name",
        "breed"
      ]
    },
    "Post": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Post",
      "type": "object",
      "description": "Represents a user-generated post in the community feed.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the post."
        },
        "authorId": {
          "type": "string",
          "description": "The UID of the user who created the post."
        },
        "content": {
          "type": "string",
          "description": "The text content of the post."
        },
        "imageUrl": {
          "type": "string",
          "description": "URL of an image attached to the post.",
          "format": "uri"
        },
        "createdAt": {
          "type": "string",
          "description": "The timestamp when the post was created.",
          "format": "date-time"
        },
        "likes": {
          "type": "array",
          "description": "An array of user UIDs who have liked the post.",
          "items": {
            "type": "string"
          }
        }
      },
      "required": [
        "id",
        "authorId",
        "content",
        "createdAt"
      ]
    },
    "Comment": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Comment",
      "type": "object",
      "description": "Represents a comment on a post.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the comment."
        },
        "authorId": {
          "type": "string",
          "description": "The UID of the user who wrote the comment."
        },
        "postId": {
          "type": "string",
          "description": "The ID of the post this comment belongs to."
        },
        "content": {
          "type": "string",
          "description": "The text content of the comment."
        },
        "createdAt": {
          "type": "string",
          "description": "The timestamp when the comment was created.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "authorId",
        "postId",
        "content",
        "createdAt"
      ]
    },
    "Conversation": {
      "title": "Conversation",
      "description": "Represents a private chat between two or more users.",
      "type": "object",
      "properties": {
        "id": { "type": "string", "description": "Unique identifier for the conversation." },
        "participants": { "type": "array", "items": { "type": "string" }, "description": "Array of user UIDs participating in the conversation." },
        "participantDetails": {
          "type": "array",
          "items": {
            "type": "object",
            "properties": {
              "uid": { "type": "string" },
              "userName": { "type": "string" },
              "profilePicture": { "type": "string", "format": "uri" }
            },
            "required": ["uid", "userName"]
          },
          "description": "Denormalized data of participants for easy display."
        },
        "lastMessage": { "type": "string", "description": "The content of the most recent message." },
        "lastMessageTimestamp": { "type": "string", "format": "date-time", "description": "Timestamp of the last message." }
      },
      "required": ["id", "participants", "participantDetails"]
    },
    "Message": {
      "title": "Message",
      "description": "Represents a single message within a conversation.",
      "type": "object",
      "properties": {
        "id": { "type": "string", "description": "Unique identifier for the message." },
        "conversationId": { "type": "string", "description": "The ID of the conversation this message belongs to." },
        "senderId": { "type": "string", "description": "The UID of the user who sent the message." },
        "content": { "type": "string", "description": "The text content of the message." },
        "createdAt": { "type": "string", "format": "date-time", "description": "Timestamp when the message was sent." }
      },
      "required": ["id", "conversationId", "senderId", "content", "createdAt"]
    },
     "Event": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "Event",
      "type": "object",
      "description": "Represents a community event.",
      "properties": {
        "id": { "type": "string", "description": "Unique identifier for the event." },
        "title": { "type": "string", "description": "The title of the event." },
        "description": { "type": "string", "description": "A detailed description of the event." },
        "location": { "type": "string", "description": "The physical location or address of the event." },
        "petType": { "type": "string", "enum": ["All", "Dog", "Cat", "Bird", "Rabbit", "Other"], "description": "The type of pet the event is for." },
        "date": { "type": "string", "format": "date-time", "description": "The date and time of the event." },
        "authorId": { "type": "string", "description": "The UID of the user who created the event." },
        "attendees": { "type": "array", "items": { "type": "string" }, "description": "An array of user UIDs who are attending the event." }
      },
      "required": ["id", "title", "location", "petType", "date", "authorId"]
    },
    "AdvicePost": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "AdvicePost",
      "type": "object",
      "description": "Represents a post in the 'Tips and Advice' section.",
      "properties": {
        "id": { "type": "string", "description": "Unique identifier for the advice post." },
        "authorId": { "type": "string", "description": "The UID of the user who created the post." },
        "title": { "type": "string", "description": "The title or question of the post." },
        "content": { "type": "string", "description": "The detailed content of the post." },
        "createdAt": { "type": "string", "format": "date-time", "description": "Timestamp when the post was created." },
        "upvotes": { "type": "array", "items": { "type": "string" }, "description": "Array of user UIDs who upvoted." },
        "downvotes": { "type": "array", "items": { "type": "string" }, "description": "Array of user UIDs who downvoted." },
        "commentCount": { "type": "number", "description": "The number of comments on the post." }
      },
      "required": ["id", "authorId", "title", "createdAt"]
    },
    "AdviceComment": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "AdviceComment",
      "type": "object",
      "description": "Represents a comment on an advice post.",
      "properties": {
        "id": { "type": "string", "description": "Unique identifier for the comment." },
        "authorId": { "type": "string", "description": "The UID of the user who wrote the comment." },
        "advicePostId": { "type": "string", "description": "The ID of the advice post this comment belongs to." },
        "content": { "type": "string", "description": "The text content of the comment." },
        "createdAt": { "type": "string", "format": "date-time", "description": "Timestamp when the comment was created." }
      },
      "required": ["id", "authorId", "advicePostId", "content", "createdAt"]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "users/{userId}",
        "definition": {
          "entityName": "UserProfile",
          "schema": { "$ref": "#/backend/entities/UserProfile" },
          "description": "Stores user profile data, using the Firebase Auth UID as the document ID.",
          "params": [{ "name": "userId", "description": "The Firebase Auth UID of the user." }]
        }
      },
      {
        "path": "pets/{petId}",
        "definition": {
          "entityName": "Pet",
          "schema": { "$ref": "#/backend/entities/Pet" },
          "description": "Stores individual pet data.",
          "params": [{ "name": "petId", "description": "The unique ID of the pet." }]
        }
      },
      {
        "path": "posts/{postId}",
        "definition": {
          "entityName": "Post",
          "schema": { "$ref": "#/backend/entities/Post" },
          "description": "Stores all user-generated posts.",
          "params": [{ "name": "postId", "description": "The unique ID of the post." }]
        }
      },
      {
        "path": "posts/{postId}/comments/{commentId}",
        "definition": {
          "entityName": "Comment",
          "schema": { "$ref": "#/backend/entities/Comment" },
          "description": "Stores comments for a specific post.",
          "params": [
            { "name": "postId", "description": "The unique ID of the post." },
            { "name": "commentId", "description": "The unique ID of the comment." }
          ]
        }
      },
       {
        "path": "conversations/{conversationId}",
        "definition": {
          "entityName": "Conversation",
          "schema": { "$ref": "#/backend/entities/Conversation" },
          "description": "Stores metadata for a conversation between users.",
          "params": [{ "name": "conversationId", "description": "The unique ID of the conversation." }]
        }
      },
      {
        "path": "conversations/{conversationId}/messages/{messageId}",
        "definition": {
          "entityName": "Message",
          "schema": { "$ref": "#/backend/entities/Message" },
          "description": "Stores messages for a specific conversation.",
          "params": [
            { "name": "conversationId", "description": "The unique ID of the conversation." },
            { "name": "messageId", "description": "The unique ID of the message." }
          ]
        }
      },
      {
        "path": "events/{eventId}",
        "definition": {
          "entityName": "Event",
          "schema": { "$ref": "#/backend/entities/Event" },
          "description": "Stores all community events.",
          "params": [{ "name": "eventId", "description": "The unique ID of the event." }]
        }
      },
      {
        "path": "advicePosts/{advicePostId}",
        "definition": {
          "entityName": "AdvicePost",
          "schema": { "$ref": "#/backend/entities/AdvicePost" },
          "description": "Stores all community advice posts.",
          "params": [{ "name": "advicePostId", "description": "The unique ID of the advice post." }]
        }
      },
      {
        "path": "advicePosts/{advicePostId}/comments/{commentId}",
        "definition": {
          "entityName": "AdviceComment",
          "schema": { "$ref": "#/backend/entities/AdviceComment" },
          "description": "Stores comments for a specific advice post.",
          "params": [
            { "name": "advicePostId", "description": "The unique ID of the advice post." },
            { "name": "commentId", "description": "The unique ID of the comment." }
          ]
        }
      }
    ],
    "reasoning": "The Firestore structure is designed for a social media application for pets. It includes top-level collections for users, pets, posts, events, conversations, and advice posts to allow for scalable queries. Comments and messages are stored as subcollections within their respective parent documents (posts, conversations, advice posts) to maintain a logical hierarchy and enable efficient retrieval. Denormalized data in conversations (participantDetails) is used to avoid extra lookups when displaying conversation lists."
  }
}
